<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta name="description" content="è‡ªç„¶ä½“é¨“ã‚’æä¾›ã™ã‚‹æä¾›å…ƒä¸€è¦§ã€‚ä¿¡é ¼ã§ãã‚‹ä¸»å‚¬è€…ã‚’è¦‹ã¤ã‘ã‚ˆã†ã€‚">
  <title>æä¾›å…ƒä¸€è¦§ | ãã¨ãªã³</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <header class="main-header" id="main-header">
    <div class="nav">
      <div class="nav-left">
        <a href="index.html" class="logo">
          <img src="assets/sotonavi-logo.png" alt="ãã¨ãªã³" class="logo-image">
        </a>
        <div class="header-search" id="header-search" style="display: none;">
          <form class="header-search-form" onsubmit="handleSearch(event)">
            <input type="text" placeholder="è¡ŒããŸã„è‡ªç„¶ä½“é¨“ãƒ»å ´æ‰€ã‚’æ¢ã™" name="q" class="header-search-input">
            <button type="submit" class="header-search-button">æ¤œç´¢</button>
          </form>
        </div>
      </div>
      <div class="nav-links">
        <a href="list.html">ã‚¤ãƒ™ãƒ³ãƒˆä¸€è¦§</a>
        <a href="organizer-list.html">æä¾›å…ƒ</a>
      </div>
    </div>
  </header>

  <main class="container">
    <div style="margin: 20px 0;">
      <h1 style="margin: 0 0 8px 0; font-size: 1.5rem;">æä¾›å…ƒä¸€è¦§</h1>
      <p style="color: #6c7a72; margin: 0;">è‡ªç„¶ä½“é¨“ã‚’æä¾›ã™ã‚‹ä¿¡é ¼ã§ãã‚‹æä¾›å…ƒã‚’ã”ç´¹ä»‹ã—ã¾ã™</p>
    </div>

    <div id="organizer-list" style="display: grid; gap: 20px; margin-top: 24px;"></div>
  </main>

  <footer class="main-footer">
    <div class="footer-content">
      <div class="footer-column">
        <h3>ã‚µãƒãƒ¼ãƒˆ</h3>
        <a href="contact.html">ãŠå•ã„åˆã‚ã›</a>
        <a href="terms.html">åˆ©ç”¨è¦ç´„</a>
        <a href="privacy.html">ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼</a>
      </div>
      <div class="footer-column">
        <h3>é‹å–¶æƒ…å ±</h3>
        <a href="about.html">é‹å–¶ã«ã¤ã„ã¦</a>
      </div>
    </div>
    <div class="footer-bottom">
      <div class="footer-copyright">
        Â© <span id="current-year"></span> ãã¨ãªã³. è£½ä½œ
      </div>
    </div>
  </footer>

  <script src="data.js"></script>
  <script>
    function renderOrganizers() {
      const container = document.getElementById('organizer-list');
      if (!container) return;

      if (eventData.organizers.length === 0) {
        container.innerHTML = `
          <div class="empty-state">
            <div class="empty-state-icon">ğŸ¢</div>
          <h3>æä¾›å…ƒãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ</h3>
          </div>
        `;
        return;
      }

      container.innerHTML = eventData.organizers.map(org => {
        const events = eventData.events.filter(e => e.organizerId === org.id);
        return `
          <div class="organizer-card">
            <div class="organizer-header">
              <img src="${org.logo}" alt="${org.name}" class="organizer-logo">
              <div class="organizer-info" style="flex: 1;">
                <h3 style="margin: 0 0 8px 0;">
                  <a href="organizer-detail.html?id=${org.id}" style="color: inherit; text-decoration: none;">
                    ${org.name}
                  </a>
                </h3>
                <p style="margin: 0; color: #6c7a72; line-height: 1.6;">${org.description}</p>
                <div class="organizer-meta">
                  <span>è¨­ç«‹: ${org.establishedYear}å¹´</span>
                  <span> â€¢ </span>
                  <span>è©•ä¾¡: â˜…${org.rating} (${org.reviewCount}ä»¶)</span>
                  <span> â€¢ </span>
                  <span>é–‹å‚¬ã‚¤ãƒ™ãƒ³ãƒˆ: ${events.length}ä»¶</span>
                </div>
              </div>
            </div>
            <div style="margin-top: 16px;">
              <a href="organizer-detail.html?id=${org.id}" class="btn" style="display: inline-block; text-align: center; padding: 12px 24px;">
                è©³ç´°ã‚’è¦‹ã‚‹ â†’
              </a>
            </div>
          </div>
        `;
      }).join('');
    }

    document.addEventListener('DOMContentLoaded', async () => {
      try {
        // APIã‹ã‚‰ã‚¤ãƒ™ãƒ³ãƒˆãƒ»æä¾›å…ƒãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿
        await loadEventData();

        const yearElement = document.getElementById('current-year');
        if (yearElement) {
          yearElement.textContent = new Date().getFullYear();
        }
        renderOrganizers();

        // ãƒ˜ãƒƒãƒ€ãƒ¼æ¤œç´¢æ¬„ã®è¡¨ç¤ºåˆ‡ã‚Šæ›¿ãˆï¼ˆãƒ’ã‚¹ãƒ†ãƒªã‚·ã‚¹ä»˜ãã§ç‚¹æ»…ã‚’é˜²æ­¢ï¼‰
        let isHeaderSearchVisible = false;
        const SHOW_THRESHOLD = 150; // ã“ã®ä½ç½®ã‚’è¶…ãˆãŸã‚‰è¡¨ç¤º
        const HIDE_THRESHOLD = 80;  // ã“ã®ä½ç½®ã‚ˆã‚Šä¸Šã«æˆ»ã£ãŸã‚‰éè¡¨ç¤º

        function handleScroll() {
          const header = document.getElementById('main-header');
          const headerSearch = document.getElementById('header-search');
          if (!header || !headerSearch) return;

          const y = window.scrollY || window.pageYOffset || 0;

          if (!isHeaderSearchVisible && y > SHOW_THRESHOLD) {
            isHeaderSearchVisible = true;
            header.classList.add('scrolled');
            headerSearch.style.display = 'block';
          } else if (isHeaderSearchVisible && y < HIDE_THRESHOLD) {
            isHeaderSearchVisible = false;
            header.classList.remove('scrolled');
            headerSearch.style.display = 'none';
          }
        }

        window.addEventListener('scroll', handleScroll);
        // åˆæœŸä½ç½®ã«å¿œã˜ã¦ä¸€åº¦åˆ¤å®š
        handleScroll();
      } catch (e) {
        console.error(e);
        const el = document.getElementById('error');
        if (el) el.textContent = 'ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ';
      }
    });
  </script>
</body>
</html>

