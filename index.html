<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta name="description" content="è‡ªç„¶ä½“é¨“ãƒ»ã‚¤ãƒ™ãƒ³ãƒˆã‚’æ¢ã—ã¦äºˆç´„ã§ãã‚‹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã€‚ãƒˆãƒ¬ãƒƒã‚­ãƒ³ã‚°ã€ã‚«ãƒ¤ãƒƒã‚¯ã€æ˜Ÿç©ºè¦³å¯Ÿãªã©ã€ã‚ãªãŸã«ã´ã£ãŸã‚Šã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‚’è¦‹ã¤ã‘ã‚ˆã†ã€‚">
  <title>è‡ªç„¶ä½“é¨“ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ  | GreenTrails</title>
  <link rel="stylesheet" href="styles.css">
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "name": "GreenTrails",
    "description": "è‡ªç„¶ä½“é¨“ãƒ»ã‚¤ãƒ™ãƒ³ãƒˆã‚’æ¢ã—ã¦äºˆç´„ã§ãã‚‹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ",
    "url": "https://example.com"
  }
  </script>
</head>
<body>
  <header class="main-header">
    <div class="nav">
      <div class="logo">GreenTrails</div>
      <div class="nav-links">
        <a href="index.html">ãƒ›ãƒ¼ãƒ </a>
        <a href="list.html">ã‚¤ãƒ™ãƒ³ãƒˆä¸€è¦§</a>
        <a href="organizer-list.html">å‚¬è¡Œä¼šç¤¾</a>
      </div>
    </div>
  </header>

  <!-- Hero Section -->
  <section class="hero-section">
    <div class="hero-content">
      <h1 class="hero-title">æ±äº¬è¿‘éƒŠã§è‡ªç„¶ä½“é¨“</h1>
      <form class="hero-search-form" id="main-search-form" onsubmit="handleSearch(event)">
        <input type="text" id="search-query" placeholder="è¡Œãå…ˆã‚„ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‚’æ¤œç´¢" name="q" class="hero-search-input">
        <button type="submit" class="hero-search-button">æ¤œç´¢</button>
      </form>
      <p class="hero-subtext">æ—…è¡Œã®è¨ˆç”»ã‚’ç¶šã‘ã‚‹</p>
    </div>
  </section>

  <main>
    <!-- ã‚«ãƒ†ã‚´ãƒª -->
    <section id="categories" class="section">
      <h2>äººæ°—ã‚«ãƒ†ã‚´ãƒª</h2>
      <div class="categories" id="category-list"></div>
    </section>

    <!-- ä»Šé€±ã®ã‚¤ãƒ™ãƒ³ãƒˆ -->
    <section class="section event-block">
      <div class="event-block-header">
        <h2>ä»Šé€±ã®ã‚¤ãƒ™ãƒ³ãƒˆ</h2>
      </div>
      <div class="week-calendar" id="week-calendar"></div>
    </section>

    <!-- ãŠã™ã™ã‚ã‚¤ãƒ™ãƒ³ãƒˆ -->
    <section class="section event-block">
      <div class="event-block-header">
        <h2>ãŠã™ã™ã‚ã‚¤ãƒ™ãƒ³ãƒˆ</h2>
        <a href="list.html?recommended=1" class="view-all">ã™ã¹ã¦è¦‹ã‚‹ â†’</a>
      </div>
      <div class="card-carousel-wrapper">
        <div class="card-carousel" id="recommended-events"></div>
        <button class="carousel-arrow carousel-arrow-right" onclick="scrollCarousel('recommended-events', 'right')">â†’</button>
      </div>
    </section>

    <!-- æ–°ç€ã‚¤ãƒ™ãƒ³ãƒˆ -->
    <section class="section event-block">
      <div class="event-block-header">
        <h2>æ–°ç€ã‚¤ãƒ™ãƒ³ãƒˆ</h2>
        <a href="list.html?new=1" class="view-all">ã™ã¹ã¦è¦‹ã‚‹ â†’</a>
      </div>
      <div class="card-carousel-wrapper">
        <div class="card-carousel" id="new-events"></div>
        <button class="carousel-arrow carousel-arrow-right" onclick="scrollCarousel('new-events', 'right')">â†’</button>
      </div>
    </section>

    <!-- ç›´è¿‘é–‹å‚¬ã‚¤ãƒ™ãƒ³ãƒˆ -->
    <section class="section event-block">
      <div class="event-block-header">
        <h2>ç›´è¿‘é–‹å‚¬ã‚¤ãƒ™ãƒ³ãƒˆ</h2>
        <a href="list.html?upcoming=1" class="view-all">ã™ã¹ã¦è¦‹ã‚‹ â†’</a>
      </div>
      <div class="card-carousel-wrapper">
        <div class="card-carousel" id="upcoming-events"></div>
        <button class="carousel-arrow carousel-arrow-right" onclick="scrollCarousel('upcoming-events', 'right')">â†’</button>
      </div>
    </section>
  </main>

  <footer class="main-footer">
    <div class="footer-content">
      <div class="footer-column">
        <h3>è¨€èª</h3>
        <select class="footer-select">
          <option>æ—¥æœ¬èª</option>
          <option>English</option>
          <option>ä¸­æ–‡</option>
        </select>
        <h3>é€šè²¨</h3>
        <select class="footer-select">
          <option>æ—¥æœ¬å†† (Â¥)</option>
          <option>USD ($)</option>
          <option>EUR (â‚¬)</option>
        </select>
      </div>
      <div class="footer-column">
        <h3>ãƒ¢ãƒã‚¤ãƒ«</h3>
        <button class="app-button">
          <span>Google Play ã§æ‰‹ã«å…¥ã‚Œã‚ˆã†</span>
        </button>
        <button class="app-button">
          <span>App Store ã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</span>
        </button>
      </div>
      <div class="footer-column">
        <h3>ã‚µãƒãƒ¼ãƒˆ</h3>
        <a href="#">ãŠå•ã„åˆã‚ã›</a>
        <a href="#">æ³•çš„æƒ…å ±</a>
        <a href="#">å€‹äººæƒ…å ±ä¿è­·æ–¹é‡</a>
        <a href="#">ã‚¯ãƒƒã‚­ãƒ¼ã¨ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°è¨­å®š</a>
        <a href="#">ä¸€èˆ¬åˆ©ç”¨è¦ç´„</a>
        <a href="#">ã‚µã‚¤ãƒˆãƒãƒƒãƒ—</a>
      </div>
      <div class="footer-column">
        <h3>ä¼šç¤¾æƒ…å ±</h3>
        <a href="#">ä¼šç¤¾æ¦‚è¦</a>
        <a href="#">æ¡ç”¨æƒ…å ±</a>
        <a href="#">ãƒ–ãƒ­ã‚°</a>
        <a href="#">å ±é“é–¢é€£</a>
        <h3 style="margin-top: 20px;">ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼å‹Ÿé›†</h3>
        <a href="#">ã‚µãƒ—ãƒ©ã‚¤ãƒ¤ãƒ¼ã¨ã—ã¦</a>
        <a href="#">ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼ã¨ã—ã¦</a>
        <a href="#">ã‚¢ãƒ•ã‚£ãƒªã‚¨ã‚¤ãƒˆãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã¨ã—ã¦</a>
      </div>
      <div class="footer-column">
        <h3>ãŠæ”¯æ‰•ã„æ–¹æ³•</h3>
        <div class="payment-methods">
          <span>PayPal</span>
          <span>Visa</span>
          <span>Mastercard</span>
          <span>JCB</span>
          <span>American Express</span>
        </div>
      </div>
    </div>
    <div class="footer-bottom">
      <div class="footer-copyright">
        Â© 2008 - 2025 GreenTrails. è£½ä½œ æ±äº¬&æ¨ªæµœ.
      </div>
      <div class="footer-social">
        <a href="#" aria-label="Facebook">f</a>
        <a href="#" aria-label="Instagram">ğŸ“·</a>
        <a href="#" aria-label="Twitter">X</a>
        <a href="#" aria-label="LinkedIn">in</a>
      </div>
    </div>
  </footer>

  <script src="data.js"></script>
  <script src="app.js"></script>
  <script>
    // ã‚«ãƒ†ã‚´ãƒªä¸€è¦§ã®è¡¨ç¤º
    function renderCategories() {
      const container = document.getElementById('category-list');
      if (!container) return;

      container.innerHTML = eventData.categories.map(cat => `
        <a href="list.html?category=${cat.id}" class="cat">
          <span>${cat.icon}</span>
          <span>${cat.name}</span>
        </a>
      `).join('');
    }


    // æ¤œç´¢å‡¦ç†
    function handleSearch(event) {
      event.preventDefault();
      const formData = new FormData(event.target);
      const params = {
        q: formData.get('q') || '',
        category: formData.get('category') || '',
        date: formData.get('date') || '',
        area: formData.get('area') || ''
      };
      URLManager.setParams(params);
      window.location.href = `list.html?${new URLSearchParams(params).toString()}`;
    }

    // æ›œæ—¥æ¤œç´¢
    function searchByWeekday(weekday) {
      window.location.href = `list.html?weekday=${weekday}`;
    }

    // ä»Šé€±ã®ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼è¡¨ç¤º
    function renderWeekCalendar() {
      const container = document.getElementById('week-calendar');
      if (!container) return;

      const today = new Date();
      today.setHours(0, 0, 0, 0);
      const dayOfWeek = today.getDay(); // 0=æ—¥æ›œæ—¥, 6=åœŸæ›œæ—¥
      const startOfWeek = new Date(today);
      startOfWeek.setDate(today.getDate() - dayOfWeek); // ä»Šé€±ã®æ—¥æ›œæ—¥

      // ä»Šé€±ã®7æ—¥é–“ã‚’å–å¾—
      const weekDays = [];
      for (let i = 0; i < 7; i++) {
        const date = new Date(startOfWeek);
        date.setDate(startOfWeek.getDate() + i);
        weekDays.push(date);
      }

      // å„æ—¥ã®ã‚¤ãƒ™ãƒ³ãƒˆæ•°ã‚’ã‚«ã‚¦ãƒ³ãƒˆ
      const eventCounts = {};
      weekDays.forEach(date => {
        const dateStr = date.toISOString().split('T')[0];
        const count = eventData.events.filter(event =>
          event.dates.some(d => d.date === dateStr)
        ).length;
        eventCounts[dateStr] = count;
      });

      // ä»Šæ—¥ã®æ—¥ä»˜æ–‡å­—åˆ—
      const todayStr = today.toISOString().split('T')[0];

      // æ›œæ—¥å
      const weekDayNames = ['æ—¥', 'æœˆ', 'ç«', 'æ°´', 'æœ¨', 'é‡‘', 'åœŸ'];

      // ãƒªã‚¹ãƒˆç”Ÿæˆ
      let html = '<div class="week-calendar-list">';

      weekDays.forEach(date => {
        const dateStr = date.toISOString().split('T')[0];
        const month = date.getMonth() + 1;
        const day = date.getDate();
        const dayName = weekDayNames[date.getDay()];
        const count = eventCounts[dateStr] || 0;
        const isToday = dateStr === todayStr;
        const hasEvents = count > 0;

        let itemClass = 'week-day-item';
        if (isToday) itemClass += ' today';
        if (hasEvents) itemClass += ' has-events';

        html += `<div class="${itemClass}" onclick="goToDateEvents('${dateStr}')">`;
        html += `<span class="week-day-date">${month}/${day}(${dayName})</span>`;
        if (hasEvents) {
          html += `<span class="week-day-count">${count}ä»¶</span>`;
        }
        html += `</div>`;
      });

      html += '</div>';
      container.innerHTML = html;
    }

    // æ—¥ä»˜ã‚¯ãƒªãƒƒã‚¯ã§ã‚¤ãƒ™ãƒ³ãƒˆä¸€è¦§ã«é·ç§»
    function goToDateEvents(dateStr) {
      window.location.href = `list.html?date=${dateStr}`;
    }

    // ã‚¤ãƒ™ãƒ³ãƒˆãƒ–ãƒ­ãƒƒã‚¯ã®è¡¨ç¤º
    function renderEventBlocks() {
      const recommended = SearchFilter.getRecommendedEvents(eventData.events);
      const newEvents = SearchFilter.getNewEvents(eventData.events);
      const upcoming = SearchFilter.getUpcomingEvents(eventData.events, 30);

      CardRenderer.renderCarousel(recommended, 'recommended-events');
      CardRenderer.renderCarousel(newEvents, 'new-events');
      CardRenderer.renderCarousel(upcoming, 'upcoming-events');
    }

    // ã‚«ãƒ«ãƒ¼ã‚»ãƒ«ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
    function scrollCarousel(carouselId, direction) {
      const carousel = document.getElementById(carouselId);
      if (!carousel) return;
      
      const scrollAmount = 400;
      const currentScroll = carousel.scrollLeft;
      const newScroll = direction === 'right' 
        ? currentScroll + scrollAmount 
        : currentScroll - scrollAmount;
      
      carousel.scrollTo({
        left: newScroll,
        behavior: 'smooth'
      });
    }

    // åˆæœŸåŒ–
    document.addEventListener('DOMContentLoaded', () => {
      renderCategories();
      renderWeekCalendar();
      renderEventBlocks();
    });
  </script>
</body>
</html>
